# 递归（recursion）



```c
long rfact(long n)
{
    long result;

    if(n <= 1)
        result = 1;
    else
        result = n * rfact(n-1);
    
    return result;
}

int main()
{
    long i = rfact(3);
    return 0;
}
```

```arm
0000000000001129 <rfact>:
    1129:       f3 0f 1e fa             endbr64 
    112d:       48 83 ff 01             cmp    $0x1,%rdi
    1131:       7f 06                   jg     1139 <rfact+0x10>
    1133:       b8 01 00 00 00          mov    $0x1,%eax
    1138:       c3                      retq   
    1139:       53                      push   %rbx
    113a:       48 89 fb                mov    %rdi,%rbx
    113d:       48 8d 7f ff             lea    -0x1(%rdi),%rdi
    1141:       e8 e3 ff ff ff          callq  1129 <rfact>
    1146:       48 0f af c3             imul   %rbx,%rax
    114a:       5b                      pop    %rbx
    114b:       c3                      retq   

000000000000114c <main>:
    114c:       f3 0f 1e fa             endbr64 
    1150:       48 83 ec 08             sub    $0x8,%rsp
    1154:       bf 03 00 00 00          mov    $0x3,%edi
    1159:       e8 cb ff ff ff          callq  1129 <rfact>
    115e:       b8 00 00 00 00          mov    $0x0,%eax
    1163:       48 83 c4 08             add    $0x8,%rsp
    1167:       c3                      retq   
    1168:       0f 1f 84 00 00 00 00    nopl   0x0(%rax,%rax,1)
    116f:       00 

Dump of assembler code for function main:
=> 0x000055555555514c <+0>:     endbr64 
   0x0000555555555150 <+4>:     sub    $0x8,%rsp
   0x0000555555555154 <+8>:     mov    $0x3,%edi
   0x0000555555555159 <+13>:    callq  0x555555555129 <rfact>
   0x000055555555515e <+18>:    mov    $0x0,%eax
   0x0000555555555163 <+23>:    add    $0x8,%rsp
   0x0000555555555167 <+27>:    retq  

(gdb) print /x $rbx
$1 = 0x555555555170

=> 0x0000555555555129 <+0>:     endbr64 
   0x000055555555512d <+4>:     cmp    $0x1,%rdi
   0x0000555555555131 <+8>:     jg     0x555555555139 <rfact+16>
   0x0000555555555133 <+10>:    mov    $0x1,%eax
   0x0000555555555138 <+15>:    retq   
   0x0000555555555139 <+16>:    push   %rbx
   0x000055555555513a <+17>:    mov    %rdi,%rbx
   0x000055555555513d <+20>:    lea    -0x1(%rdi),%rdi
   0x0000555555555141 <+24>:    callq  0x555555555129 <rfact>
   0x0000555555555146 <+29>:    imul   %rbx,%rax
   0x000055555555514a <+33>:    pop    %rbx
   0x000055555555514b <+34>:    retq   

main 
initial %rsp 0x7fffffffdfe8
before call $2 = 0x7fffffffdfe0

n=3 %rdi
initial %rbx  0x555555555170 %rsp  0x7fffffffdfd8
before callq  %rbx 0x3 %rdi 0x2 %rsp 0x7fffffffdfd0

n=2 &rdi
initial %rbx  0x3 %rsp 0x7fffffffdfc8
before callq  %rbx 0x2 %rdi 0x1 %rsp 0x7fffffffdfc0

n=1 %rdi
initial %rbx  0x2 %rsp 0x7fffffffdfb8
0x7fffffffdfb8 0x555555555146
before callq  %rbx 0x1  %rax 0x1

```